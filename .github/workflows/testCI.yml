name: Detect Services & Projects

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Display Configurations
        shell: pwsh
        run: |
          # Read backend list (produced by previous Load Config step)
          $frontendRoot = Join-Path $env:GITHUB_WORKSPACE "Frontend"
          $repoRoot = $env:GITHUB_WORKSPACE

          Get-ChildItem -Path $frontendRoot -Directory | ForEach-Object {
              $serviceDir = $_.FullName
              $packageJsonPath = Join-Path $serviceDir "package.json"

              # Only treat folders with package.json as frontend apps
              if (-not (Test-Path $packageJsonPath)) {
                  return
              }

              # Convert to relative path
              $relativeServiceDir = $serviceDir.Replace($repoRoot, "").TrimStart(@('\','/'))
              $relativeServiceDir = $relativeServiceDir.Replace('\','/')

              Write-Host "`n============ Frontend service: $relativeServiceDir ============"

              echo "Frontend Service Path: $relativeServiceDir"
          }

        
